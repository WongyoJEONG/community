<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>회원가입</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        .form-container { max-width: 500px; margin: 50px auto; }
    </style>

    <script>
        function formCheck(e) {
            // submit 이벤트를 일단 멈춤 (SweetAlert는 비동기라서)
            e.preventDefault();

            let id = document.getElementById("memberId");
            let pw = document.getElementById("memberPw");
            let name = document.getElementById("name");

            if (id.value.length < 3 || id.value.length > 10) {
                Swal.fire({
                    icon: 'error',
                    title: '아이디 확인',
                    text: '아이디는 3~10자 사이여야 합니다!'
                });
                return false;
            }

            if (pw.value.length < 3 || pw.value.length > 10) {
                Swal.fire({
                    icon: 'warning',
                    title: '비밀번호 확인',
                    text: '비밀번호는 3~10자 사이여야 합니다!'
                });
                return false;
            }

            if (name.value.length == 0) {
                Swal.fire('이름을 입력해주세요!');
                return false;
            }

            // 모든 검사 통과 시 성공 메시지 후 전송
            Swal.fire({
                icon: 'success',
                title: '가입 완료!',
                text: '환영합니다. 로그인 페이지로 이동합니다.',
                showConfirmButton: false,
                timer: 1500
            }).then(() => {
                // 실제 폼 전송
                document.getElementById("joinForm").submit();
            });
        }
    </script>
</head>
<body class="bg-light">

<div class="container form-container">
    <div class="card shadow">
        <div class="card-header bg-primary text-white text-center">
            <h3 class="mb-0">회원가입</h3>
        </div>
        <div class="card-body p-4">
            <form id="joinForm" th:action="@{/member/join}" method="post" onsubmit="formCheck(event)">

                <div class="mb-3">
                    <label class="form-label">아이디</label>
                    <input type="text" name="memberId" id="memberId" class="form-control" placeholder="3~10자 입력">
                </div>

                <div class="mb-3">
                    <label class="form-label">비밀번호</label>
                    <input type="password" name="memberPw" id="memberPw" class="form-control" placeholder="3~10자 입력">
                </div>

                <div class="mb-3">
                    <label class="form-label">이름</label>
                    <input type="text" name="name" id="name" class="form-control">
                </div>

                <div class="mb-3">
                    <label class="form-label">이메일</label>
                    <input type="email" name="email" id="email" class="form-control">
                </div>

                <div class="d-grid gap-2">
                    <input type="submit" value="가입하기" class="btn btn-primary btn-lg">
                </div>
            </form>

            <div class="mt-3 text-center">
                <a th:href="@{/}" class="text-decoration-none">HOME으로</a>
            </div>
        </div>
    </div>
</div>

</body>
</html>